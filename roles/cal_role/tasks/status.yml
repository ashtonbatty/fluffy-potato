---
- name: "Check service status for {{ cal_role_service_name }}"
  ansible.builtin.command: "{{ cal_role_service_script }} status"
  register: cal_role_status_result
  failed_when: false
  changed_when: false
  async: "{{ cal_role_script_timeout }}"
  poll: 1

- name: "Display service status for {{ cal_role_service_name }}"
  ansible.builtin.debug:
    msg:
      - "Service: {{ cal_role_service_name }}"
      - "Status output: {{ cal_role_status_result.stdout }}"
      - "Return code: {{ cal_role_status_result.rc }}"
      - "Running: {{ 'Yes' if cal_role_running_check_string in cal_role_status_result.stdout else 'No' }}"
      - "Stopped: {{ 'Yes' if cal_role_stopped_check_string in cal_role_status_result.stdout else 'No' }}"
